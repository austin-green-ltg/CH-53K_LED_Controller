\doxysection{C\+:/\+Users/agreen/\+Documents/\+Projects/\+Aveo/\+CH-\/53\+K\+\_\+\+LED\+\_\+\+Controller/\+Core/\+Src/pwm\+\_\+handler.c File Reference}
\hypertarget{pwm__handler_8c}{}\label{pwm__handler_8c}\index{C:/Users/agreen/Documents/Projects/Aveo/CH-\/53K\_LED\_Controller/Core/Src/pwm\_handler.c@{C:/Users/agreen/Documents/Projects/Aveo/CH-\/53K\_LED\_Controller/Core/Src/pwm\_handler.c}}
{\ttfamily \#include "{}pwm\+\_\+handler.\+h"{}}\newline
{\ttfamily \#include "{}stm32l412xx-\/bsp.\+h"{}}\newline
{\ttfamily \#include "{}temperature\+\_\+handler.\+h"{}}\newline
{\ttfamily \#include "{}my\+\_\+printf.\+h"{}}\newline
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{pwm__handler_8c_a0be5620d1275557da247a47aa2a88f17}{PW\+\_\+\+PERIOD}}~(255)
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{pwm__handler_8c_a9e440816ccf6e7ae8f8bdea60b99fe99}{Init\+Pwm}} (void)
\begin{DoxyCompactList}\small\item\em Init Pwm\+Array var Set brightness to half value, enable pwm, and turn off. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{pwm__handler_8c_a48727f45bdc5237463baf264e8e5d706}{Decrease\+Brightness}} (uint8\+\_\+t button\+\_\+held, uint8\+\_\+t is\+Ir)
\begin{DoxyCompactList}\small\item\em Decrease brightness by 1 (for button press) or 3 (for button hold) This functions can be made to increase brightness value with the REVERSE\+\_\+\+BRIGHTNESS flag Afterwards, set pwm output. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{pwm__handler_8c_a79fe1926935a52243ab75394e65e05cb}{Increase\+Brightness}} (uint8\+\_\+t button\+\_\+held, uint8\+\_\+t is\+Ir)
\begin{DoxyCompactList}\small\item\em Increase brightness by 1 (for button press) or 3 (for button hold) This functions can be made to decrease brightness value with the REVERSE\+\_\+\+BRIGHTNESS flag Afterwards, set pwm output. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{pwm__handler_8c_a8e2bc7e471b367a9d3f877ce5af05796}{Set\+Pwm}} (uint8\+\_\+t is\+Ir)
\begin{DoxyCompactList}\small\item\em set PWM based on pwm value \end{DoxyCompactList}\item 
void \mbox{\hyperlink{pwm__handler_8c_a90359218ff4b8771a3764beeecfb8e14}{Turn\+Off\+Pwm}} (void)
\begin{DoxyCompactList}\small\item\em turn off PWM \end{DoxyCompactList}\item 
int8\+\_\+t \mbox{\hyperlink{pwm__handler_8c_a77ea589d9b01990f67fa3402f3f8cfa8}{Get\+Brightness}} (uint8\+\_\+t is\+Ir)
\begin{DoxyCompactList}\small\item\em Return Brightness variable. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{pwm__handler_8c_a8a6c2c1c8f63b789a2f18b7402b046d9}{Set\+Brightness}} (int8\+\_\+t brightness, uint8\+\_\+t is\+Ir)
\begin{DoxyCompactList}\small\item\em Set Brightness variable, guards to ensure we don\textquotesingle{}t go over max or min. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{pwm__handler_8c_aab23730a61ee18a06b9b440fae2a4f0f}{Get\+Pwm}} (uint8\+\_\+t is\+Ir)
\begin{DoxyCompactList}\small\item\em Get the PWM value based on the brightness and the temperature range. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const uint8\+\_\+t \mbox{\hyperlink{pwm__handler_8c_ae1796e9c87bd5bbdc6951e57caf04ecc}{Max\+Brightness}} = ( \mbox{\hyperlink{pwm__handler_8h_a6c3df8dbdbdd67989551b1659654ae17}{BRIGHTNESS\+\_\+\+STEPS}} -\/ 1 )
\item 
const uint8\+\_\+t \mbox{\hyperlink{pwm__handler_8c_a61917e7b25a47c075d6457ab2b8188f3}{Min\+Brightness}} = ( 0 )
\item 
const uint8\+\_\+t \mbox{\hyperlink{pwm__handler_8c_ab36ab7a2f3bfc2b6d00bd30632e3a6a0}{Half\+Brightness}}
\item 
const float \mbox{\hyperlink{pwm__handler_8c_a5954d5859d46f73640991a358064f089}{Min\+Pw}} = ( 0 )
\item 
const float \mbox{\hyperlink{pwm__handler_8c_ab38246c9cb6577f574e9ac0aed724080}{Max\+Pw}} = ( \mbox{\hyperlink{pwm__handler_8c_a0be5620d1275557da247a47aa2a88f17}{PW\+\_\+\+PERIOD}} )
\item 
const float \mbox{\hyperlink{pwm__handler_8c_afe83b2f0adbc3ca4b929b0785dc9c80f}{Warm\+Pwm\+Ratio}} = ( 0.\+90f )
\item 
const float \mbox{\hyperlink{pwm__handler_8c_aad560e09a587936e63cedfc0b827fe62}{Hot\+Pwm\+Ratio}} = ( 0.\+50f )
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\Hypertarget{pwm__handler_8c_a0be5620d1275557da247a47aa2a88f17}\index{pwm\_handler.c@{pwm\_handler.c}!PW\_PERIOD@{PW\_PERIOD}}
\index{PW\_PERIOD@{PW\_PERIOD}!pwm\_handler.c@{pwm\_handler.c}}
\doxysubsubsection{\texorpdfstring{PW\_PERIOD}{PW\_PERIOD}}
{\footnotesize\ttfamily \label{pwm__handler_8c_a0be5620d1275557da247a47aa2a88f17} 
\#define PW\+\_\+\+PERIOD~(255)}



\doxysubsection{Function Documentation}
\Hypertarget{pwm__handler_8c_a48727f45bdc5237463baf264e8e5d706}\index{pwm\_handler.c@{pwm\_handler.c}!DecreaseBrightness@{DecreaseBrightness}}
\index{DecreaseBrightness@{DecreaseBrightness}!pwm\_handler.c@{pwm\_handler.c}}
\doxysubsubsection{\texorpdfstring{DecreaseBrightness()}{DecreaseBrightness()}}
{\footnotesize\ttfamily \label{pwm__handler_8c_a48727f45bdc5237463baf264e8e5d706} 
void Decrease\+Brightness (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{button\+\_\+held}{, }\item[{uint8\+\_\+t}]{is\+Ir}{}\end{DoxyParamCaption})}



Decrease brightness by 1 (for button press) or 3 (for button hold) This functions can be made to increase brightness value with the REVERSE\+\_\+\+BRIGHTNESS flag Afterwards, set pwm output. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em button\+\_\+held} & If the button is being held (decrements by 3 if so) \\
\hline
\mbox{\texttt{ in}}  & {\em is\+Ir} & Are we controlling IR or Visible LEDs \\
\hline
\end{DoxyParams}
\Hypertarget{pwm__handler_8c_a77ea589d9b01990f67fa3402f3f8cfa8}\index{pwm\_handler.c@{pwm\_handler.c}!GetBrightness@{GetBrightness}}
\index{GetBrightness@{GetBrightness}!pwm\_handler.c@{pwm\_handler.c}}
\doxysubsubsection{\texorpdfstring{GetBrightness()}{GetBrightness()}}
{\footnotesize\ttfamily \label{pwm__handler_8c_a77ea589d9b01990f67fa3402f3f8cfa8} 
int8\+\_\+t Get\+Brightness (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{is\+Ir}{}\end{DoxyParamCaption})}



Return Brightness variable. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em is\+Ir} & Are we controlling IR or Visible LEDs \\
\hline
\mbox{\texttt{ out}}  & {\em Current} & LED brightness level \\
\hline
\end{DoxyParams}
\Hypertarget{pwm__handler_8c_aab23730a61ee18a06b9b440fae2a4f0f}\index{pwm\_handler.c@{pwm\_handler.c}!GetPwm@{GetPwm}}
\index{GetPwm@{GetPwm}!pwm\_handler.c@{pwm\_handler.c}}
\doxysubsubsection{\texorpdfstring{GetPwm()}{GetPwm()}}
{\footnotesize\ttfamily \label{pwm__handler_8c_aab23730a61ee18a06b9b440fae2a4f0f} 
uint8\+\_\+t Get\+Pwm (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{is\+Ir}{}\end{DoxyParamCaption})}



Get the PWM value based on the brightness and the temperature range. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em is\+Ir} & Are we controlling IR or Visible LEDs \\
\hline
\mbox{\texttt{ out}}  & {\em Current} & PWM value \\
\hline
\end{DoxyParams}
\Hypertarget{pwm__handler_8c_a79fe1926935a52243ab75394e65e05cb}\index{pwm\_handler.c@{pwm\_handler.c}!IncreaseBrightness@{IncreaseBrightness}}
\index{IncreaseBrightness@{IncreaseBrightness}!pwm\_handler.c@{pwm\_handler.c}}
\doxysubsubsection{\texorpdfstring{IncreaseBrightness()}{IncreaseBrightness()}}
{\footnotesize\ttfamily \label{pwm__handler_8c_a79fe1926935a52243ab75394e65e05cb} 
void Increase\+Brightness (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{button\+\_\+held}{, }\item[{uint8\+\_\+t}]{is\+Ir}{}\end{DoxyParamCaption})}



Increase brightness by 1 (for button press) or 3 (for button hold) This functions can be made to decrease brightness value with the REVERSE\+\_\+\+BRIGHTNESS flag Afterwards, set pwm output. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em button\+\_\+held} & If the button is being held (increments by 3 if so) \\
\hline
\mbox{\texttt{ in}}  & {\em is\+Ir} & Are we controlling IR or Visible LEDs \\
\hline
\end{DoxyParams}
\Hypertarget{pwm__handler_8c_a9e440816ccf6e7ae8f8bdea60b99fe99}\index{pwm\_handler.c@{pwm\_handler.c}!InitPwm@{InitPwm}}
\index{InitPwm@{InitPwm}!pwm\_handler.c@{pwm\_handler.c}}
\doxysubsubsection{\texorpdfstring{InitPwm()}{InitPwm()}}
{\footnotesize\ttfamily \label{pwm__handler_8c_a9e440816ccf6e7ae8f8bdea60b99fe99} 
void Init\+Pwm (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}



Init Pwm\+Array var Set brightness to half value, enable pwm, and turn off. 

\Hypertarget{pwm__handler_8c_a8a6c2c1c8f63b789a2f18b7402b046d9}\index{pwm\_handler.c@{pwm\_handler.c}!SetBrightness@{SetBrightness}}
\index{SetBrightness@{SetBrightness}!pwm\_handler.c@{pwm\_handler.c}}
\doxysubsubsection{\texorpdfstring{SetBrightness()}{SetBrightness()}}
{\footnotesize\ttfamily \label{pwm__handler_8c_a8a6c2c1c8f63b789a2f18b7402b046d9} 
void Set\+Brightness (\begin{DoxyParamCaption}\item[{int8\+\_\+t}]{brightness}{, }\item[{uint8\+\_\+t}]{is\+Ir}{}\end{DoxyParamCaption})}



Set Brightness variable, guards to ensure we don\textquotesingle{}t go over max or min. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em brightness} & Brightness to set \\
\hline
\mbox{\texttt{ in}}  & {\em is\+Ir} & Are we controlling IR or Visible LEDs \\
\hline
\end{DoxyParams}
\Hypertarget{pwm__handler_8c_a8e2bc7e471b367a9d3f877ce5af05796}\index{pwm\_handler.c@{pwm\_handler.c}!SetPwm@{SetPwm}}
\index{SetPwm@{SetPwm}!pwm\_handler.c@{pwm\_handler.c}}
\doxysubsubsection{\texorpdfstring{SetPwm()}{SetPwm()}}
{\footnotesize\ttfamily \label{pwm__handler_8c_a8e2bc7e471b367a9d3f877ce5af05796} 
void Set\+Pwm (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{is\+Ir}{}\end{DoxyParamCaption})}



set PWM based on pwm value 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em is\+Ir} & Are we controlling IR or Visible LEDs \\
\hline
\end{DoxyParams}
\Hypertarget{pwm__handler_8c_a90359218ff4b8771a3764beeecfb8e14}\index{pwm\_handler.c@{pwm\_handler.c}!TurnOffPwm@{TurnOffPwm}}
\index{TurnOffPwm@{TurnOffPwm}!pwm\_handler.c@{pwm\_handler.c}}
\doxysubsubsection{\texorpdfstring{TurnOffPwm()}{TurnOffPwm()}}
{\footnotesize\ttfamily \label{pwm__handler_8c_a90359218ff4b8771a3764beeecfb8e14} 
void Turn\+Off\+Pwm (\begin{DoxyParamCaption}\item[{void}]{}{}\end{DoxyParamCaption})}



turn off PWM 



\doxysubsection{Variable Documentation}
\Hypertarget{pwm__handler_8c_ab36ab7a2f3bfc2b6d00bd30632e3a6a0}\index{pwm\_handler.c@{pwm\_handler.c}!HalfBrightness@{HalfBrightness}}
\index{HalfBrightness@{HalfBrightness}!pwm\_handler.c@{pwm\_handler.c}}
\doxysubsubsection{\texorpdfstring{HalfBrightness}{HalfBrightness}}
{\footnotesize\ttfamily \label{pwm__handler_8c_ab36ab7a2f3bfc2b6d00bd30632e3a6a0} 
const uint8\+\_\+t Half\+Brightness}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{=\ (\ (\ uint8\_t\ )\ (\ (\ \mbox{\hyperlink{pwm__handler_8h_a6c3df8dbdbdd67989551b1659654ae17}{BRIGHTNESS\_STEPS}}\ -\/\ 1\ )\ /}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2.0f\ )\ )}

\end{DoxyCode}
Half Brightness Step (24) \Hypertarget{pwm__handler_8c_aad560e09a587936e63cedfc0b827fe62}\index{pwm\_handler.c@{pwm\_handler.c}!HotPwmRatio@{HotPwmRatio}}
\index{HotPwmRatio@{HotPwmRatio}!pwm\_handler.c@{pwm\_handler.c}}
\doxysubsubsection{\texorpdfstring{HotPwmRatio}{HotPwmRatio}}
{\footnotesize\ttfamily \label{pwm__handler_8c_aad560e09a587936e63cedfc0b827fe62} 
const float Hot\+Pwm\+Ratio = ( 0.\+50f )}

Hot thermal state pwm constant \Hypertarget{pwm__handler_8c_ae1796e9c87bd5bbdc6951e57caf04ecc}\index{pwm\_handler.c@{pwm\_handler.c}!MaxBrightness@{MaxBrightness}}
\index{MaxBrightness@{MaxBrightness}!pwm\_handler.c@{pwm\_handler.c}}
\doxysubsubsection{\texorpdfstring{MaxBrightness}{MaxBrightness}}
{\footnotesize\ttfamily \label{pwm__handler_8c_ae1796e9c87bd5bbdc6951e57caf04ecc} 
const uint8\+\_\+t Max\+Brightness = ( \mbox{\hyperlink{pwm__handler_8h_a6c3df8dbdbdd67989551b1659654ae17}{BRIGHTNESS\+\_\+\+STEPS}} -\/ 1 )}

Max Brightness Step (49) \Hypertarget{pwm__handler_8c_ab38246c9cb6577f574e9ac0aed724080}\index{pwm\_handler.c@{pwm\_handler.c}!MaxPw@{MaxPw}}
\index{MaxPw@{MaxPw}!pwm\_handler.c@{pwm\_handler.c}}
\doxysubsubsection{\texorpdfstring{MaxPw}{MaxPw}}
{\footnotesize\ttfamily \label{pwm__handler_8c_ab38246c9cb6577f574e9ac0aed724080} 
const float Max\+Pw = ( \mbox{\hyperlink{pwm__handler_8c_a0be5620d1275557da247a47aa2a88f17}{PW\+\_\+\+PERIOD}} )}

Max pulse width value (\doxylink{pwm__handler_8c_a0be5620d1275557da247a47aa2a88f17}{PW\+\_\+\+PERIOD(255)}) \Hypertarget{pwm__handler_8c_a61917e7b25a47c075d6457ab2b8188f3}\index{pwm\_handler.c@{pwm\_handler.c}!MinBrightness@{MinBrightness}}
\index{MinBrightness@{MinBrightness}!pwm\_handler.c@{pwm\_handler.c}}
\doxysubsubsection{\texorpdfstring{MinBrightness}{MinBrightness}}
{\footnotesize\ttfamily \label{pwm__handler_8c_a61917e7b25a47c075d6457ab2b8188f3} 
const uint8\+\_\+t Min\+Brightness = ( 0 )}

Min Brightness Step (0) \Hypertarget{pwm__handler_8c_a5954d5859d46f73640991a358064f089}\index{pwm\_handler.c@{pwm\_handler.c}!MinPw@{MinPw}}
\index{MinPw@{MinPw}!pwm\_handler.c@{pwm\_handler.c}}
\doxysubsubsection{\texorpdfstring{MinPw}{MinPw}}
{\footnotesize\ttfamily \label{pwm__handler_8c_a5954d5859d46f73640991a358064f089} 
const float Min\+Pw = ( 0 )}

Min pulse width value (0) \Hypertarget{pwm__handler_8c_afe83b2f0adbc3ca4b929b0785dc9c80f}\index{pwm\_handler.c@{pwm\_handler.c}!WarmPwmRatio@{WarmPwmRatio}}
\index{WarmPwmRatio@{WarmPwmRatio}!pwm\_handler.c@{pwm\_handler.c}}
\doxysubsubsection{\texorpdfstring{WarmPwmRatio}{WarmPwmRatio}}
{\footnotesize\ttfamily \label{pwm__handler_8c_afe83b2f0adbc3ca4b929b0785dc9c80f} 
const float Warm\+Pwm\+Ratio = ( 0.\+90f )}

Warm thermal state pwm constant 